# Правила форматирования для конвертации DOCX в Markdown

Правила форматирования для конвертации DOCX в Markdown:

## 1. Структура файлов

### Frontmatter
Каждый файл должен начинаться с YAML frontmatter:
```yaml
---
title: Название главы/раздела
nextRead:         # (опционально)
  to: /путь/к/следующей/странице
  label: Название следующей страницы
---
```

### Основной заголовок
После frontmatter идет заголовок первого уровня, совпадающий с title:
```markdown
# Название главы
```

## 2. Заголовки

### Система нумерации
- H1 (`#`) - основной заголовок главы без номера
- H2 (`##`) - разделы с нумерацией типа "1.1", "2.1", "3.1"
- H3 (`###`) - подразделы с тройной нумерацией (например, 3.1.1)
- Формат: `## X.Y Название раздела`

### Сохранение исходной нумерации
Конвертер должен сохранять номера разделов в формате `X.Y` точно так, как в исходном документе, без пропусков и изменений.

### Избегание дублирования заголовков
- Не допускается повторение одинаковых заголовков в одном файле
- Каждый уровень заголовка должен использоваться последовательно
- H1 заголовок должен быть единственным в файле

### Примеры:
- `# Общие сведения`
- `## 1.1 Функциональное назначение` 
- `## 2.2 Состав плагинов`
- `### 3.1.1 Подраздел`

## 3. Специальные блоки

### AppAnnotation блок
Используется для важной информации/аннотаций и визуально выделяется цветным фоном:
```markdown
::AppAnnotation
Текст аннотации может быть многострочным.
Описывает ключевые моменты раздела.
::
```

### Критерии применения AppAnnotation
- Используется для длинных описательных блоков (2+ предложения)
- Применяется к обзорной и архитектурной информации
- Содержит ключевые концепции и определения
- Соседние короткие блоки объединяются в один большой AppAnnotation

### Фоновое выделение
- Других видов фонового выделения в образцах не обнаружено;
- Примечания отображаются через `blockquote`, что также создаёт серый фон у текста.

## 4. Списки

### Маркированные списки
- Используется символ `-` (дефис) с пробелом
- Поддерживается многоуровневая вложенность
- Длинные элементы списка могут переноситься на несколько строк

Примеры:
```markdown
- обеспечение разработчиков каталогом документации;
- предоставление примеров фрагментов кода;
- ускорение процессов разработки.
```

### Объединение абзацев в списки
Последовательные абзацы, представляющие пункты перечисления, должны объединяться в маркированный список. Каждый абзац становится элементом списка с маркером `-`.

### Критерии автоматического создания списков
Должны конвертироваться в маркированные списки:
- Последовательности задач, функций или компонентов
- Перечисления требований
- Списки технологий и инструментов
- Описания элементов архитектуры

### Описательные списки компонентов
Названия компонентов заключаются в обратные кавычки, описание отделяется длинным тире. Каждый элемент заканчивается точкой с запятой, последний — точкой.
```markdown
- `Компонент` — описание компонента;
- `Другой компонент` — его описание.
```

## 5. Таблицы

### Стандартные таблицы
```markdown
| Заголовок 1 | Заголовок 2 | Заголовок 3 |
| ----------- | ----------- | ----------- |
| Данные      | Данные      | Данные      |
```

### Таблицы с выравниванием
```markdown
| Левый        | Центр  | Правый |
| :----------- | :----: | -----: |
| Левое        | Центр  | Правое |
```

### Переносы в ячейках
Для переносов строк в ячейках используется `<br>`:
```markdown
| Колонка |
| ------- |
| Строка 1<br>Строка 2<br>Строка 3 |
```

### Группировка строк и пустые ячейки
Для имитации объединённых ячеек используются отдельные строки с заполненной первой колонкой и пустыми остальными:
```markdown
| Браузер       | ОС           | Процессор |
| ------------- | ------------ | --------- |
| Google Chrome |              |           |
| Windows       | Windows 10   | Intel Pentium 4 |
| Linux         | Debian 10    | Intel Pentium 4 |
| Yandex Browser|              |           |
| Windows       | Windows 7    | Intel Pentium 4 |
```

### Подписи к таблицам
После каждой таблицы идет подпись в формате blockquote:
```markdown
> Таблица X – Описание таблицы
```

## 6. Примечания и цитаты

### Примечания
```markdown
> _Примечание_ – Текст примечания.
> Может быть многострочным.
```

### Обычные blockquote
```markdown
> Обычная цитата без специального форматирования
```

## 7. Inline форматирование

### Код
- Используются обратные кавычки для `кода`
- Технические термины и названия ПО: `Winter CMS`, `PostgreSQL`, `Docker`
- Стандарты и языки: `HTML5`, `CSS3`, `JavaScript`
- Многострочных блоков кода в образцах нет

### Акценты
- Курсив для терминов: _Примечание_
- Жирный для важных понятий (редко используется в образцах)

## 8. Ссылки

### Внутренние ссылки
```markdown
[разделе 7](/developer/administrator/winter-cms)
```

## 9. Абзацы и разделение

### Интервалы
- Пустая строка между абзацами
- Пустая строка после заголовков
- Пустая строка после списков
- Пустая строка после таблиц и их подписей

### Длинные абзацы
Абзацы могут быть довольно длинными и содержать несколько предложений без принудительных переносов.

### Обработка повторяющегося контента
- Удаляются дублирующиеся абзацы
- Объединяются повторяющиеся фразы
- Проверяется уникальность ключевых конструкций

## 10. Обработка изображений

Согласно requirements должны обрабатываться в формате:
```
::sign-image
src: <src>
sign: <sign>
::
```

## 11. Нумерация разделов

### Схема нумерации:
- Глава 1: разделы 1.1, 1.2, 1.3, 1.4
- Глава 2: разделы 2.1, 2.2, 2.3, ..., 2.9
- Глава 3: разделы 3.1, 3.2, 3.3

### В заголовках:
- Номер главы отсутствует в H1
- Номер раздела присутствует в H2
- Подразделы (если есть) будут H3 с тройной нумерацией (например, 3.1.1)

## 12. Консистентность стиля

### Технические термины
- Названия ПО всегда в обратных кавычках
- Аббревиатуры без кавычек: HTML5, CSS3, JavaScript
- Названия стандартов: ISO/IEC 9075:2011

### Пунктуация
- Списки заканчиваются точкой с запятой, последний элемент - точкой
- Описания в списках компонентов заканчиваются точкой с запятой
- В таблицах точки обычно не ставятся

### Языковые особенности
- Документы на русском языке
- Соблюдается официально-деловой стиль
- Используется техническая терминология

## 15. Блоки кода

### Указание языка программирования и имени файла
```markdown
```yaml docker-compose.yaml
version: "3"
services:
  web:
    image: nginx
```

### Терминальные команды с указанием Terminal
```markdown
```bash Terminal
sudo dnf install docker docker-compose
```

### Обычные блоки кода с языком
```markdown
```bash
sysctl -w net.core.somaxconn=1024
```

### Конфигурационные файлы
```markdown
```conf tuned.conf
[main]
include = throughput-performance
```

### Многострочные YAML блоки
```markdown
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: cpu-affinity-example
```

## 16. Навигация в frontmatter

### Двунаправленная навигация
```yaml
---
title: Название главы

readPrev:
  to: /path/to/previous
  label: Предыдущий раздел

readNext:
  to: /path/to/next
  label: Следующий раздел
---
```

### Простая навигация вперед
```yaml
---
title: Название главы

nextRead:
  to: /path/to/next
  label: Следующий раздел
---
```

## 17. HTML таблицы для сложного форматирования

Когда стандартные Markdown таблицы не подходят из-за сложной структуры, используются HTML таблицы:

```html
<div class="joplin-table-wrapper">
    <table>
        <thead>
            <tr>
                <th>Параметр</th>
                <th>Команды</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <p>vm.swappiness</p>
                    <p>Управляет склонностью ядра использовать swap...</p>
                </td>
                <td>
                    <p>Проверка текущего значения:</p>
                    <p>sysctl vm.swappiness</p>
                </td>
            </tr>
        </tbody>
    </table>
</div>
```

## 18. Продвинутые паттерны ссылок

### Внутренние ссылки с якорями
```markdown
[разделе 7](/developer/administrator/winter-cms)
[3.1](/developer/administrator/technical-requirements#_31-требования-к-программному-обеспечению)
[см. раздел 6.2](/developer/administrator/monitoring#_62-хранение-постоянных-данных)
```

### Ссылки на разделы той же страницы
```markdown
([см. раздел 5.1.5](/developer/administrator/setup-os#_515-оптимизация-файловой-системы-и-дискового-ввода-вывода))
```

### Внешние ссылки с описанием
```markdown
[формирование описано в официальной документации](https://doc.traefik.io/traefik/middlewares/http/basicauth/)
```

### Прямые ссылки
```markdown
[https://git.rosa.ru/](https://git.rosa.ru/)
```

## 19. Расширенные inline элементы

### Комбинированное форматирование компонентов
```markdown
- `CMS-сервер` (`Winter CMS`) — основной элемент серверной части;
- плагины `Winter CMS` — модули, расширяющие функциональность CMS;
```

### Технические термины разных типов
- Названия ПО: `Winter CMS`, `PostgreSQL`, `Docker`
- Стандарты: `HTML5`, `CSS3`, `JavaScript`
- Протоколы и форматы: `HTTP(S)`, `TLS`, `JSON`, `YAML`
- Команды и утилиты: `sysctl`, `docker ps`, `systemctl`

### Курсив для служебных элементов
```markdown
> _Примечание_ – Текст примечания.
```

## 20. Специальные символы и форматирование

### Длинные тире
Используются длинные тире (—) в описаниях компонентов:
```markdown
- `CMS-сервер` (`Winter CMS`) — основной элемент серверной части;
```

### Кавычки
- Обычные кавычки для названий: "Портал разработчика"
- Двойные кавычки для строковых значений: "10240 65535"

### Специальные переносы в таблицах
В ячейках таблиц используются `<br>` для переносов:
```markdown
| Колонка |
| ------- |
| Windows 10;<br><br>Windows Server 2016 |
```

## 21. Нумерация и структура подразделов

### Многоуровневая нумерация разделов
Для подразделов используется нумерация типа:
- #### 5.1.1.1 sysctl
- #### 5.1.1.2 Tuned  
- #### 5.1.1.3 Дополнительные утилиты

### Нумерация глав и разделов в заголовках
- Глава 1: разделы 1.1, 1.2, 1.3, 1.4
- Глава 2: разделы 2.1, 2.2, 2.3, ..., 2.9
- И так далее

